---
title: ""
author: "Casey Bray"
date: "10/16/2021"
output: pdf_document

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readxl) ## To read in excel sheets. 
library(ggplot2) ## for plotting Bar and line graphs
library(gridExtra) ## To organize graphs into columns. 
```


```{r functions, echo=FALSE, include = FALSE}

peakanalyze <- function(x) {
## Print name of current data frame to distinguish in summary. 
print(as.character(as.list(match.call())$x))

## Provide summary statistics of numerical data
print(summary(x))

## print NA and duplicate values if present
cat("\nDuplicates: ", sum(duplicated(x)))  
cat("\n NA Values: ", sum(is.na(x)), "\n\n")

## Omit NA values for balanced plots. 
x <- na.omit(x)

## Define outliers to plot in title of graph
out1 <- boxplot.stats(x$Intensity1)$out
out2 <- boxplot.stats(x$Intensity2)$out
out3 <- boxplot.stats(x$Intensity3)$out
outliers_ <- c(out1,out2,out3)

## Extract Name of data frame for graph title
title <- as.character(as.list(match.call())$x)

## Melt Time data into separate variable for boxplots.
x_melt <- reshape2::melt(x[,c(2,4,6)], id.vars=NULL)
m1 <- ggplot(x_melt, aes(x = variable, y = value)) +            
   geom_boxplot() +
   ggtitle(paste(title, paste(" Intensity Boxplot, Outliers: ",
                 paste(outliers_, collapse = ", "))))

mean_1 <- round(mean(x$Intensity1))
mean_2 <- round(mean(x$Intensity2))
mean_3 <- round(mean(x$Intensity3))
means <- c(mean_1,mean_2,mean_3)

## Visualize all triplicate peaks together to view differences/similarities
peak1 <- ggplot() +
  geom_line(data=x,aes(x=Time1,y=Intensity1,colour="Intensity 1"),size=1) +
  geom_line(data=x,aes( x=Time2, y= Intensity2,colour="Intensity 2"),size=1, linetype = 'twodash') + 
  geom_line(data=x,aes(x=Time3, y= Intensity3,colour="Intensity 3"),size=1, linetype = 'dashed') +
  scale_color_manual(name = "Intensity", values = c("Intensity 1" = "red",
                                                    "Intensity 2" = "blue",
                                                    "Intensity 3" = "green")) +
   ggtitle(paste(title, paste(" Intensities, AUC 1 ~ 3: ",
                 paste(means, collapse = ", ")))) +
   labs(y="Intensity", x = "Time")

## plot 
grid.arrange(m1, peak1, ncol=1) 
}

## Function to plot the intensities of each three pills for multiple
## between-group comparison by color-coding.
bet_group_line <- function(x,y,z) {
peak1 <- ggplot() +
  geom_line(data=x,aes(x=Time1,y=Intensity1,colour="Bayer"),size=1) +
  geom_line(data=y,aes( x=Time1, y= Intensity1,colour="PV"),size=1, linetype = 'twodash') + 
  geom_line(data=z,aes(x=Time1, y= Intensity1,colour="WAL"),size=1, linetype = 'dashed') +
  scale_color_manual(name = "Intensity", values = c("Bayer" = "red", "PV" = "blue",
                                                    "WAL" =    "green")) +
   ggtitle(" Intensity Peak 1") +
   labs(y="Intensity", x = "Time")
peak2 <- ggplot() +
  geom_line(data=x,aes(x=Time2,y=Intensity2,colour="Bayer"),size=1) +
  geom_line(data=y,aes( x=Time2, y= Intensity2,colour="PV"),size=1, linetype = 'twodash') + 
  geom_line(data=z,aes(x=Time2, y= Intensity2,colour="WAL"),size=1, linetype = 'dashed') +
  scale_color_manual(name = "Intensity", values = c("Bayer" = "red",
                                                    "PV" = "blue",
                                                    "WAL" = "green")) +
   ggtitle(" Intensity Peak 2") +
   labs(y="Intensity", x = "Time")
peak3 <- ggplot() +
  geom_line(data=x,aes(x=Time3,y=Intensity3,colour="Bayer"),size=1) +
  geom_line(data=y,aes( x=Time3, y= Intensity3,colour="PV"),size=1, linetype = 'twodash') + 
  geom_line(data=z,aes(x=Time3, y= Intensity3,colour="WAL"),size=1, linetype = 'dashed') +
  scale_color_manual(name = "Intensity", values = c("Bayer" = "red",
                                                    "PV" = "blue",
                                                    "WAL" = "green")) +
   ggtitle(" Intensity Peak 3") +
   labs(y="Intensity", x = "Time")

grid.arrange(peak1,peak2,peak3, ncol=2)
}

## I used this function to bind the means from each pill into one data frame 
## for my aov functions below. Code copied from Tyler Rinker at:
## https://stackoverflow.com/questions/7962267/cbind-a-dataframe-with-an-empty-dataframe-cbind-fil
cbind.fill <- function(...){
    nm <- list(...) 
    nm <- lapply(nm, as.matrix)
    n <- max(sapply(nm, nrow)) 
    do.call(cbind, lapply(nm, function (x) 
        rbind(x, matrix(, n-nrow(x), ncol(x))))) 
}

## Extract the average of each column and put into a variablename. Then, join
## all three into a dataframe and convert into a matrix. Also create a copy of 
## the matrix that is in categorical format to perfom the aov.
## The function the performs aov and prints a summary and required plots.
## A tukey is also printed to asses which groups differ. 
between_groups <- function(pv1,pv2,pv3,wa1,wa2,wa3,ba1,ba2,ba3){
p1 <- mean(colMeans(pv1[ , c(2,4,6)]), na.rm = TRUE)
p2 <- mean(colMeans(pv2[ , c(2,4,6)]),na.rm = TRUE)
p3 <- mean(colMeans(pv3[ , c(2,4,6)]),na.rm = TRUE)
  PV_Means<- c(p1,p2,p3)

w1 <- mean(colMeans(wa1[,c(2,4,6)], na.rm = TRUE))
w2 <- mean(colMeans(wa2[,c(2,4,6)], na.rm = TRUE))
w3 <- mean(colMeans(wa3[,c(2,4,6)], na.rm = TRUE))
  WAL_Means <- c(w1,w2,w3)

b1 <- mean(colMeans(ba1[ , c(2,4,6)], na.rm = TRUE))
b2 <- mean(colMeans(ba2[ , c(2,4,6)], na.rm = TRUE))
b3 <- mean(colMeans(ba3[ , c(2,4,6)], na.rm = TRUE))
  Bayer_Means <- c(b1,b2,b3)

x <- as.data.frame(cbind.fill(Bayer_Means, PV_Means))
  x <- as.data.frame(cbind.fill(x, WAL_Means))

AUP = c(t(as.matrix(x)))

f = c("Bayer", "PV", "WAL") 
k = 3 
n = 3

Brands = gl(k, 1, n*k, factor(f))

model = aov(AUP ~ Brands)

print("Between Group Summary: Bayer, PV, WAL")
print(summary(model))

par(mfrow=c(2,2))
plot(model)

tmodel <- TukeyHSD(model, conf.level = 0.95)
print("Tukey HSD Test:")
print(tmodel)

par(mfrow=c(1,1))
plot(tmodel, las=1)
}
```

- Data Prep
For data prep took each folder into an excel spreadsheet. I used "Get Data" to 
bring in each text file into its own individual sheet and manipulated the data 
by removing everything but the time and intensity columns for each of the three
aliquots. I then renamed each column, time1 time2...etc. This way I could get a
look at all the data individually and have all three peak analysis for each pill 
in one file. To finish, I named each excel file the same name as the original peak 
file and left each sheet the name of the file for the pill sample. All seven files
were then put into one folder. 

```{r dataset, 136.5 92.90 All three brands (Bayer, PV, Walgreens)}
Bayer_1.1 <- read_excel('136.5 92.90.xlsx', sheet = 1)
Bayer_1.2 <- read_excel('136.5 92.90.xlsx', sheet = 2)
Bayer_1.3 <- read_excel('136.5 92.90.xlsx', sheet = 3)
PV_1.1 <- read_excel('136.5 92.90.xlsx', sheet = 4)
PV_1.2 <- read_excel('136.5 92.90.xlsx', sheet = 5)
PV_1.3 <- read_excel('136.5 92.90.xlsx', sheet = 6)
WAL_1.1 <- read_excel('136.5 92.90.xlsx', sheet = 7)
WAL_1.2 <- read_excel('136.5 92.90.xlsx', sheet = 8)
WAL_1.3 <- read_excel('136.5 92.90.xlsx', sheet = 9)

## Perform within-group analysis of Bayer pills. 
peakanalyze(Bayer_1.1)
peakanalyze(Bayer_1.2)
peakanalyze(Bayer_1.3)
## Perform within-group analysis of PV pills
peakanalyze(PV_1.1)
peakanalyze(PV_1.2)
peakanalyze(PV_1.3)
## Perform within-group analysis of WAL pills.
peakanalyze(WAL_1.1)
peakanalyze(WAL_1.2)
peakanalyze(WAL_1.3)
## Perform between-group analysis of 136.5 92.90 peaks
bet_group_line(Bayer_1.1, PV_1.1,WAL_1.1)
bet_group_line(Bayer_1.2, PV_1.2,WAL_1.2)
bet_group_line(Bayer_1.3, PV_1.3,WAL_1.3)
between_groups(PV_1.1,PV_1.2,PV_1.3,WAL_1.1,WAL_1.2,WAL_1.3,Bayer_1.1,Bayer_1.2,Bayer_1.3)
```
Bayer - Intensity1 in Bayer pills 2 and 3 seems to be considerably different than the 
other two. AUC for Bayer three, intensity1 is significantly different than the other
two. Outliers are present in all three Pill samples. Pills 1 and 3 have different
distributions for Intensity2. 
PV -  Pill 3 Intensity 2 appears distinctly different with a higher AUC and a left
skewed distribution. Pills 1 and 2 look similar. Outliers are present in all three 
samples. 
WAL - AUC for intensity 1 in pills 2 and 3 is much larger than other two. All three 
intensities in pill 1 have slight skewed distribution. Outliers present in only
pill 3. 
Between group ANOVA - Pill 1 plots show Bayer being significantly different than other two brands. The other two plots look very similar. AOV shows a p-value > .05. We can reject 
the null hypothesis and conclude that there is no difference between all three 
pill brands for this peak. QQplot shows that residuals fit line very well and 
residuals vs fitted is horizontal at zero with no distinct patterns. This suggest
assumptions for anova are good. 

```{r 178.7 93.00}
Bayer_2.1 <- read_excel('178.7 93.00.xlsx', sheet = 1)
Bayer_2.2 <- read_excel('178.7 93.00.xlsx', sheet = 2)
Bayer_2.3 <- read_excel('178.7 93.00.xlsx', sheet = 3)
PV_2.1 <- read_excel('178.7 93.00.xlsx', sheet = 4)
PV_2.2 <- read_excel('178.7 93.00.xlsx', sheet = 5)
PV_2.3 <- read_excel('178.7 93.00.xlsx', sheet = 6)
WAL_2.1 <- read_excel('178.7 93.00.xlsx', sheet = 7)
WAL_2.2 <- read_excel('178.7 93.00.xlsx', sheet = 8)
WAL_2.3 <- read_excel('178.7 93.00.xlsx', sheet = 9)

## Perform within-group analysis of Bayer pills. 
peakanalyze(Bayer_2.1)
peakanalyze(Bayer_2.2)
peakanalyze(Bayer_2.3)
## Perform within-group analysis of PV pills
peakanalyze(PV_2.1)
peakanalyze(PV_2.2)
peakanalyze(PV_2.3)
## Perform within-group analysis of WAL pills.
peakanalyze(WAL_2.1)
peakanalyze(WAL_2.2)
peakanalyze(WAL_2.3)
## Perform between-group analysis of 136.5 92.90 peaks
bet_group_line(Bayer_2.1, PV_2.1,WAL_2.1)
bet_group_line(Bayer_2.2, PV_2.2,WAL_2.2)
bet_group_line(Bayer_2.3, PV_2.3, WAL_2.3)
between_groups(PV_2.1,PV_2.2,PV_2.3,WAL_2.1,WAL_2.2,WAL_2.3,Bayer_2.1,Bayer_2.2,
               Bayer_2.3)
```
Bayer - Pill 1 has a skewed distribution for all three pills. AUC appears to be 
consistent for all three pills. Outliers present in all three pills. Pill 2, 
intensities 2 and 3 appear to be distinctly different in line plot. Outliers present
in all three pills. 
PV - Normal distribution throughout all three pills. Pill 2 has outliers and AUC
for intensity1 is quite a bit higher than other two. Line plot shows intensity1 
looks different as well. Pill3 intensity3 looks lower than other two, AUC is a 
few thousand less as well. Outliers in pill 2
WAL - Pill 1 intensity 2 looks higher and the AUC is quite a bit more than other 
two. AUCs for other two pills are consistent. Line plots look similar. Outlier in 
pill 1.

Between group analysis - Line plots look similar for all three pills. Between 
group ANOVA shows that all three means are similar with a pvalue of 0.132. We can reject 
the null hypothesis and conclude that there is no difference between all three 
pill brands for this peak. QQplot shows slight upper and lower tails, residuals 
fit well throughtout center. Residuals vs fitted is horizontal at zero with no 
distinguishable patterns. This suggests assumptions for anova are good. 

``` {r 199.10 91.90, war}
Bayer_3.1 <- read_excel('199.10 91.90.xlsx', sheet = 1)
Bayer_3.2 <- read_excel('199.10 91.90.xlsx', sheet = 2)
Bayer_3.3 <- read_excel('199.10 91.90.xlsx', sheet = 3)
PV_3.1 <- read_excel('199.10 91.90.xlsx', sheet = 4)
PV_3.2 <- read_excel('199.10 91.90.xlsx', sheet = 5)
PV_3.3 <- read_excel('199.10 91.90.xlsx', sheet = 6)
WAL_3.1 <- read_excel('199.10 91.90.xlsx', sheet = 7)
WAL_3.2 <- read_excel('199.10 91.90.xlsx', sheet = 8)
WAL_3.3 <- read_excel('199.10 91.90.xlsx', sheet = 9)

## Perform within-group analysis of Bayer pills. 
peakanalyze(Bayer_3.1)
peakanalyze(Bayer_3.2)
peakanalyze(Bayer_3.3)
## Perform within-group analysis of PV pills
peakanalyze(PV_3.1)
peakanalyze(PV_3.2)
peakanalyze(PV_3.3)
## Perform within-group analysis of WAL pills.
peakanalyze(WAL_3.1)
peakanalyze(WAL_3.2)
peakanalyze(WAL_3.3)
## Perform between-group analysis of 136.5 92.90 peaks
bet_group_line(Bayer_3.1, PV_3.1,WAL_3.1)
bet_group_line(Bayer_3.2, PV_3.2,WAL_3.2)
bet_group_line(Bayer_3.3, PV_3.3,WAL_3.3)
between_groups(PV_3.1,PV_3.2,PV_3.3,WAL_3.1,WAL_3.2,WAL_3.3,Bayer_3.1,Bayer_3.2,
               Bayer_3.3)
```
Bayer - Pill 1 intensity2 has an AUC different than other two and appears different
in line plot. Pill 2 intensity2 has narrower distribution than other two. Pill 3 
intensity3 has much lower AUC and appears different in line plot. Outlier in pill 3.
PV - At least one AUC is significantly higher than the other two in all three pills. 
Intensity1 appears different in pills 1 and 2. Pill2 intensity1 has wider distribution
that is slightly skewed. Outliers in pills 1 and 2.
WAL -  In pills 1 and 2, AUCs show at least one value significantly lower than
other two.

Between group ANOVA - In line plot for first pills, Bayer looks significantly different
than other two. Other two plots show distinct differences in all three. Between 
group ANOVA shows a p-value of 00545. We can accept the alt hypothesis, at least one
groups is different. TukeyHSD shows PV-Bayer and WAL-PV have distinct differences.
QQplot shows residuals fit line well. Residuals vs fitted shows a pretty linear fit
and no distinct patterns. 

```{r 199.10 92.90}
Bayer_4.1 <- read_excel('199.10 92.90.xlsx', sheet = 1)
Bayer_4.2 <- read_excel('199.10 92.90.xlsx', sheet = 2)
Bayer_4.3 <- read_excel('199.10 92.90.xlsx', sheet = 3)
PV_4.1 <- read_excel('199.10 92.90.xlsx', sheet = 4)
PV_4.2 <- read_excel('199.10 92.90.xlsx', sheet = 5)
PV_4.3 <- read_excel('199.10 92.90.xlsx', sheet = 6)
WAL_4.1 <- read_excel('199.10 92.90.xlsx', sheet = 7)
WAL_4.2 <- read_excel('199.10 92.90.xlsx', sheet = 8)
WAL_4.3 <- read_excel('199.10 92.90.xlsx', sheet = 9)

## Perform within-group analysis of Bayer pills. 
peakanalyze(Bayer_4.1)
peakanalyze(Bayer_4.2)
peakanalyze(Bayer_4.3)
## Perform within-group analysis of PV pills
peakanalyze(PV_4.1)
peakanalyze(PV_4.2)
peakanalyze(PV_4.3)
## Perform within-group analysis of WAL pills.
peakanalyze(WAL_4.1)
peakanalyze(WAL_4.2)
peakanalyze(WAL_4.3)
## Perform between-group analysis of 136.5 92.90 peaks
bet_group_line(Bayer_4.1, PV_4.1,WAL_4.1)
bet_group_line(Bayer_4.2, PV_4.2,WAL_4.2)
bet_group_line(Bayer_4.3, PV_4.3,WAL_4.3)
between_groups(PV_4.1,PV_4.2,PV_4.3,WAL_4.1,WAL_4.2,WAL_4.3,Bayer_4.1,Bayer_4.2,
               Bayer_4.3)
```

Bayer - Pill 1 intensity1 looks different in line plot. Pill 1 intensity 2 AUC is much
lower than other two. AUC for pill 2 intensity1 is much higher than other two. Line
plots for pills 2 and 3 look similar. 
PV - Line plots look similar throughout all three pills. Outliers present in two pills.
Skewed distributions for all in pill 1
WAL: - Pill 1 intensity 1 appears different in line plot. Pill 3 Intensity 3 AUC
is much lower than the other two. 

Betweeen group ANOVA - PV looks different from other two brands in line plot 1 and 2.
Bayer is lower than other two in line plot 2. Between group AOV returns a p-value of 
0.0016. We can accept the alt hypothesis and conclude at least one of the groups is
different. TukeyHSD shows that PV-Bayer and WAL-PV are different. QQplot shows 
residuals fit line well and residuals vs fitted shows a very small non linear trend. 
However, there are no patterns. 

```{r 199.10 137.00}
Bayer_5.1 <- read_excel('199.10 137.00.xlsx', sheet = 1)
Bayer_5.2 <- read_excel('199.10 137.00.xlsx', sheet = 2)
Bayer_5.3 <- read_excel('199.10 137.00.xlsx', sheet = 3)
PV_5.1 <- read_excel('199.10 137.00.xlsx', sheet = 4)
PV_5.2 <- read_excel('199.10 137.00.xlsx', sheet = 5)
PV_5.3 <- read_excel('199.10 137.00.xlsx', sheet = 6)
WAL_5.1 <- read_excel('199.10 137.00.xlsx', sheet = 7)
WAL_5.2 <- read_excel('199.10 137.00.xlsx', sheet = 8)
WAL_5.3 <- read_excel('199.10 137.00.xlsx', sheet = 9)

## Perform within-group analysis of Bayer pills. 
peakanalyze(Bayer_5.1)
peakanalyze(Bayer_5.2)
peakanalyze(Bayer_5.3)
## Perform within-group analysis of PV pills
peakanalyze(PV_5.1)
peakanalyze(PV_5.2)
peakanalyze(PV_5.3)
## Perform within-group analysis of WAL pills.
peakanalyze(WAL_5.1)
peakanalyze(WAL_5.2)
peakanalyze(WAL_5.3)
## Perform between-group analysis of 136.5 92.90 peaks
bet_group_line(Bayer_5.1, PV_5.1,WAL_5.1)
bet_group_line(Bayer_5.2, PV_5.2,WAL_5.2)
bet_group_line(Bayer_5.3, PV_5.3,WAL_5.3)
between_groups(PV_5.1,PV_5.2,PV_5.3,WAL_5.1,WAL_5.2,WAL_5.3,Bayer_5.1,Bayer_5.2,
               Bayer_5.3)
```

Bayer - Outlier in pill 3. Line plots look relatively similar. AUCs are similar.
PV - Outliers in pill 2.  Pill 3 intensity 1 looks different from other two. AUCs
are similar.
WAL - Intensity1 looks different in pills 1 and 2. AUCs are similar for all three
pills.

Between group ANOVA - PV is different in line plot 1. Plots 2 and 3, all three 
brands look similar. Between group AOV shows a p-value of 0.00582. We can accept 
the alt hypothesis and conclude that at least one group is different. TukeyHSD 
shows that PV-Bayer and WAL-Bayer are different. QQplot shows a slight lower tail. 
Residuals vs fitted shows a non-linear trend. However, there is no pattern. 

```{r 240.00 92.900}
Bayer_6.1 <- read_excel('240.00 92.900.xlsx', sheet = 1)
Bayer_6.2 <- read_excel('240.00 92.900.xlsx', sheet = 2)
Bayer_6.3 <- read_excel('240.00 92.900.xlsx', sheet = 3)
PV_6.1 <- read_excel('240.00 92.900.xlsx', sheet = 4)
PV_6.2 <- read_excel('240.00 92.900.xlsx', sheet = 5)
PV_6.3 <- read_excel('240.00 92.900.xlsx', sheet = 6)
WAL_6.1 <- read_excel('240.00 92.900.xlsx', sheet = 7)
WAL_6.2 <- read_excel('240.00 92.900.xlsx', sheet = 8)
WAL_6.3 <- read_excel('240.00 92.900.xlsx', sheet = 9)

## Perform within-group analysis of Bayer pills. 
peakanalyze(Bayer_6.1)
peakanalyze(Bayer_6.2)
peakanalyze(Bayer_6.3)
## Perform within-group analysis of PV pills
peakanalyze(PV_6.1)
peakanalyze(PV_6.2)
peakanalyze(PV_6.3)
## Perform within-group analysis of WAL pills.
peakanalyze(WAL_6.1)
peakanalyze(WAL_6.2)
peakanalyze(WAL_6.3)
## Perform between-group analysis of 136.5 92.90 peaks
bet_group_line(Bayer_6.1, PV_6.1,WAL_6.1)
bet_group_line(Bayer_6.2, PV_6.2,WAL_6.2)
bet_group_line(Bayer_6.3, PV_6.3,WAL_6.3)
between_groups(PV_6.1,PV_6.2,PV_6.3,WAL_6.1,WAL_6.2,WAL_6.3,Bayer_6.1,Bayer_6.2,
               Bayer_6.3)
```

Bayer - Outliers in all three pills. Distribution is pretty narrow for each pill.
Pill 1 intensity1 peak appears different than other two. Differences are found
between all three in pills 2 and 3. AUCs are similar. 
PV - Outliers in all three pills. Pill 1 intensity 1 AUC different than other two.
Line plots show differences in all three intensities. All intensities are slightly
skewed.
WAL - Outliers in all three pills. AUCs consistent. Line plots show differences 
between all three intensities in all three pills. 

Betweeen group ANOVA - All three line plots show distinct differences between all 
three brands.  Between group AOV shows a p-value of 0.00557. We can accept 
the alt hypothesis and conclude that at least one group is different. TukeyHSD 
shows that PV-Bayer and WAL-Bayer are different. QQplot shows a slight lower tail
and residuals vs fitted shows a non-linear trend. However there is no pattern.

```{r 240.00 137.100}
Bayer_7.1 <- read_excel('240.00 137.100.xlsx', sheet = 1)
Bayer_7.2 <- read_excel('240.00 137.100.xlsx', sheet = 2)
Bayer_7.3 <- read_excel('240.00 137.100.xlsx', sheet = 3)
PV_7.1 <- read_excel('240.00 137.100.xlsx', sheet = 4)
PV_7.2 <- read_excel('240.00 137.100.xlsx', sheet = 5)
PV_7.3 <- read_excel('240.00 137.100.xlsx', sheet = 6)
WAL_7.1 <- read_excel('240.00 137.100.xlsx', sheet = 7)
WAL_7.2 <- read_excel('240.00 137.100.xlsx', sheet = 8)
WAL_7.3 <- read_excel('240.00 137.100.xlsx', sheet = 9)

## Perform within-group analysis of Bayer pills. 
peakanalyze(Bayer_7.1)
peakanalyze(Bayer_7.2)
peakanalyze(Bayer_7.3)
## Perform within-group analysis of PV pills
peakanalyze(PV_7.1)
peakanalyze(PV_7.2)
peakanalyze(PV_7.3)
## Perform within-group analysis of WAL pills.
peakanalyze(WAL_7.1)
peakanalyze(WAL_7.2)
peakanalyze(WAL_7.3)
## Perform between-group analysis of 136.5 92.90 peaks
bet_group_line(Bayer_7.1, PV_7.1,WAL_7.1)
bet_group_line(Bayer_7.2, PV_7.2,WAL_7.2)
bet_group_line(Bayer_7.3, PV_7.3,WAL_7.3)
between_groups(PV_7.1,PV_7.2,PV_7.3,WAL_7.1,WAL_7.2,WAL_7.3,Bayer_7.1,Bayer_7.2,
               Bayer_7.3)
```
Bayer - Outliers in all three pills. Pill 3 intensity3 is skewed. Distribution is
narrow for all three intensities in pill 2. AUCs are consistent for all three pills.
Line plots show differences between all three intensities in all three pills. 
PV - Outliers in all three pills. Varying distributions for all three pill intensities.
AUCs are consistent. Line plots show differences between all three intensities in 
all three pills. 
WAL - Outliers in all three pills. All intensities are skewed for all pills. AUCs
are consistent for all. Line plots show differences between all three intensities in 
all three pills. 

Between group AOV - Line plots show distinct differences between all three brands
in all three plots. Between group AOV shows a p-value of 0.00228. We can accept 
the alt hypothesis and conclude that at least one group is different. TukeyHSD 
shows that PV-Bayer and WAL-Bayer are different. QQplot shows residuals fit line 
well and Residuals vs fitted shows a pretty linear trend with no patterns. 
